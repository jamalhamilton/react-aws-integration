(this.webpackJsonpidcompare=this.webpackJsonpidcompare||[]).push([[0],{126:function(e,t,a){e.exports=a(586)},131:function(e,t,a){},54:function(e,t){},583:function(e,t,a){},586:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),l=a(27),r=a.n(l),i=(a(131),a(26)),s=a(7),c=a(593),u=a(594),m=a(16),d=a(17),h=a(43),p=a(14),g=a(19),f=a(20),y=a(589),E=a(590),v=a(115),b=a(591),k=a(596),T=a(61),S=a.n(T),w=a(35),C=a.n(w),I=a(114),_=a.n(I),P="http://localhost:3000/",j="34d614b8c18543abd81f338aaeb7b0de",O={siteUrl:P,idme:{cliendId:j,clientSecret:"949e15f3b1dace8c2a3c685032d4e28d",redirectUrl:"http://localhost:3000//idme_code",authEndPoint:"https://api.id.me/oauth/authorize?client_id="+j+"&redirect_uri=http://localhost:3000//idme_code&response_type=token&scope=loa3"},aws:{accessKey:"AKIAVJKPVCLEKM2YG33J",secretKey:"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",region:"us-east-2",bucket:"idauth"},api:{verifyID:"/verifyID",getUser:"/api/getUser",registerUser:"/api/registerUser",sendMail:"/api/sendMail",sendResultMail:"/api/sendResultMail",updateUserInfo:"/api/updateUserInfo"}},U=a(595),x={width:1280,height:720,facingMode:"user"},M={width:1280,height:720,facingMode:{exact:"environment"}},B=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var n;Object(m.a)(this,a),n=t.call(this);var l=new URLSearchParams(e.location.search).get("token");if(!l)return window.location.href="/",Object(h.a)(n);var r=parseInt(l.substr(-1))-8;l=l.substr(0,l.length-1),n.webcamRef=o.a.createRef(),n.state={userToken:l,authStep:r,verifyURL:O.siteUrl+O.api.verifyID+"?token="+l+"9",isPhotoTaken:!1,imageSrc:"",photo_source:"",photo_target:"",uploadedPhoto:"",uploadedId:"",blob:"",resultMsg:"",msgColor:"black",resultBtnStatus:0,uploadingProgress:0,showLoadingIcon:{display:"none"},apiTmr:0},n.photoCapture=n.photoCapture.bind(Object(p.a)(n)),n.photoTake=n.photoTake.bind(Object(p.a)(n)),n.comparePhoto=n.comparePhoto.bind(Object(p.a)(n)),n.navToVerify=n.navToVerify.bind(Object(p.a)(n));var i=n.getMobileOperatingSystem();return"Android"!=i&&"iOS"!=i||(x=M),n}return Object(d.a)(a,[{key:"getMobileOperatingSystem",value:function(){var e=navigator.userAgent||navigator.vendor||window.opera;return/windows phone/i.test(e)?"Windows Phone":/android/i.test(e)?"Android":/iPad|iPhone|iPod/.test(e)&&!window.MSStream?"iOS":/JavaFX/.test(e)?"JavaFx":"unknown"}},{key:"componentDidMount",value:function(){var e=this,t=this.state.userToken;fetch(O.api.getUser,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({token:t})}).then((function(e){return e.json()})).then((function(t){t.status&&(e.state.photo_source=t.data.id+"_face.jpg",e.state.photo_target=t.data.id+"_id.jpg"),e.setState({uploadedPhoto:t.data.verify_photo,uploadedId:t.data.verify_idcard})})).catch((function(e){window.location.href="/"})),clearInterval(this.state.apiTmr),t&&(this.state.apiTmr=setInterval((function(){e.state.uploadedId?clearInterval(e.state.apiTmr):fetch(O.api.getUser,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({token:t})}).then((function(e){return e.json()})).then((function(t){e.setState({uploadedPhoto:t.data.verify_photo,uploadedId:t.data.verify_idcard}),t.data.verify_idcard&&clearInterval(e.state.apiTmr)})).catch((function(e){window.location.href="/"}))}),3e3))}},{key:"photoTake",value:function(){var e=this.state.isPhotoTaken,t="";e||(t=this.webcamRef.current.getScreenshot())?(this.setState({isPhotoTaken:!e,imageSrc:t}),console.log("--------- imageSrc")):this.setState({msgColor:"red",resultMsg:"Camera is not connected!!",imageSrc:""})}},{key:"photoCapture",value:function(){var e=this,t=this.state,a=t.authStep,n=t.userToken,o=t.imageSrc,l=this.state,r=l.photo_source,i=l.photo_target;C.a.config.update({accessKeyId:O.aws.accessKey,secretAccessKey:O.aws.secretKey,region:O.aws.region});var s=new C.a.S3({params:{Bucket:O.aws.bucket}}),c=r;1===a&&(c=i),o=this.dataURItoBlob(o);var u=new File([o],c),m={Key:u.name,ContentType:"image/jpeg",Body:u};e.setState({msgColor:"black",resultMsg:"",uploadingProgress:.1}),s.putObject(m,(function(t,o){if(t)return alert(t.message),!1;var l={verify_photo:c};1===a&&(l={verify_idcard:c}),l.token=n,fetch(O.api.updateUserInfo,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(l)}).then((function(e){return e.json()})).then((function(t){t.status&&(1===a?window.location.href="/idsuccess":(e.setState({msgColor:"black",resultMsg:"Uploading done."}),console.log("-------- uploaded: ",t),setTimeout((function(){e.setState({authStep:0,resultMsg:"",imageSrc:"",isPhotoTaken:!1,resultBtnStatus:0,uploadingProgress:0})}),1e3))),console.log("data",t.data)}))})).on("httpUploadProgress",(function(t){console.log("---- uploading progress: ",t),console.log("---- uploading progress: ",t.loaded/t.total*100);var a=parseInt(t.loaded/t.total*100);e.setState({uploadingProgress:a})}))}},{key:"navToVerify",value:function(){var e=this,t=this.state.userToken;this.setState({showLoadingIcon:{display:"inline-block"}}),fetch(O.api.getUser,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({token:t})}).then((function(e){return e.json()})).then((function(t){if(t.status){var a="";if(t.data.verify_idcard||(a="You didn't upload id card photo."),t.data.verify_photo||(a="You didn't upload face photo."),a)return void e.setState({msgColor:"red",resultMsg:a,showLoadingIcon:{display:"none"}});e.setState({photo_source:t.data.verify_photo,photo_target:t.data.verify_idcard}),e.comparePhoto()}else e.setState({msgColor:"red",resultMsg:"Server connection failed.",showLoadingIcon:{display:"none"}})}))}},{key:"dataURItoBlob",value:function(e){for(var t=atob(e.split(",")[1]),a=e.split(",")[0].split(":")[1].split(";")[0],n=[],o=0;o<t.length;o++)n.push(t.charCodeAt(o));return new Blob([new Uint8Array(n)],{type:a})}},{key:"comparePhoto",value:function(){var e=this,t=e.state,a=t.resultBtnStatus,n=t.userToken;if(a)e.setState({authStep:0,resultBtnStatus:0,showLoadingIcon:{display:"none"}});else{var o=O.aws.bucket,l=this.state,r=l.photo_source,i=l.photo_target;C.a.config.update({accessKeyId:O.aws.accessKey,secretAccessKey:O.aws.secretKey,region:O.aws.region});var s=new C.a.Rekognition,c={SourceImage:{S3Object:{Bucket:o,Name:r}},TargetImage:{S3Object:{Bucket:o,Name:i}},SimilarityThreshold:70};console.log("-- compare 0");try{s.compareFaces(c,(function(t,a){if(t)return console.log(t,t.stack),void e.setState({resultBtnStatus:1,msgColor:"red",resultMsg:"You didn't upload exact personal photo.",showLoadingIcon:{display:"none"}});a.FaceMatches.length?a.FaceMatches.forEach((function(t){t.Face.BoundingBox;var a=t.Similarity;fetch(O.api.updateUserInfo,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({token:n,verify_result:a})}).then((function(e){return e.json()})).then((function(t){t.status&&(console.log("-------- uploaded: ",t),fetch(O.api.sendResultMail,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({token:t.token,similarity:a})}).then((function(e){return e.json()})).then((function(t){console.log(t),t.status?window.location.href=t.data:e.setState({resultBtnStatus:1,msgColor:"red",resultMsg:t.data,showLoadingIcon:{display:"none"}})}))),console.log("data",t.data)}))})):e.setState({resultBtnStatus:1,msgColor:"red",resultMsg:"User and ID is not matched!",showLoadingIcon:{display:"none"}})}))}catch(u){e.setState({resultBtnStatus:1,msgColor:"red",resultMsg:"You didn't upload exact personal photo."}),console.log(u)}}}},{key:"render",value:function(){var e=this.state.authStep;return o.a.createElement(y.a,{style:{textAlign:"center"}},0===e&&o.a.createElement("div",null,o.a.createElement(E.a,{style:{marginTop:50}},o.a.createElement(v.a,null,o.a.createElement("h1",null,"Step 2. Verify Your Information"))),o.a.createElement(U.a,null),o.a.createElement(E.a,{style:{marginTop:30}},o.a.createElement(v.a,null,o.a.createElement("h4",null,"Your Face Photo"),o.a.createElement("img",{src:this.state.imageSrc,style:{marginBottom:6,display:this.state.isPhotoTaken?"inline-block":"none"}}),o.a.createElement(S.a,{style:{display:this.state.isPhotoTaken?"none":"inline-block"},videoConstraints:x,screenshotFormat:"image/jpeg",ref:this.webcamRef}),o.a.createElement("p",null,o.a.createElement(b.a,{variant:"primary",onClick:this.photoTake},this.state.isPhotoTaken?"Retake Photo":"Take A Photo"),o.a.createElement(b.a,{style:{marginLeft:30,display:this.state.isPhotoTaken?"inline-block":"none"},variant:"primary",onClick:this.photoCapture},"Upload"))),0===e&&o.a.createElement(v.a,null,o.a.createElement("h4",null,"Your ID card"),o.a.createElement(_.a,{value:this.state.verifyURL,size:256,level:"Q",includeMargin:!0}),o.a.createElement("p",null,o.a.createElement("a",{href:this.state.verifyURL},this.state.verifyURL)),this.state.uploadedId?o.a.createElement("p",{style:{color:"red"}},"ID has been submitted."):o.a.createElement("p",null,"Please scan this link and upload id card on your phone."))),o.a.createElement(U.a,null),o.a.createElement(E.a,{style:{marginTop:30}},o.a.createElement(v.a,null,o.a.createElement(b.a,{variant:"primary",onClick:this.navToVerify},o.a.createElement("i",{style:this.state.showLoadingIcon,className:"fa fa-spinner fa-spin"}),"Verify Information"))),this.state.uploadingProgress>0&&o.a.createElement("div",null,o.a.createElement(E.a,{style:{marginTop:30}},o.a.createElement(v.a,null),o.a.createElement(v.a,null,o.a.createElement(k.a,{now:this.state.uploadingProgress,label:this.state.uploadingProgress+"%",animated:!0})),o.a.createElement(v.a,null)))),1===e&&o.a.createElement("div",null,o.a.createElement(E.a,{style:{marginTop:50}},o.a.createElement(v.a,null,o.a.createElement("h1",null,"Upload Your ID Card"))),o.a.createElement(U.a,null),o.a.createElement(E.a,{style:{marginTop:30}},o.a.createElement(v.a,null,o.a.createElement("img",{src:this.state.imageSrc,style:{marginBottom:6,display:this.state.isPhotoTaken?"inline-block":"none"}}),o.a.createElement(S.a,{style:{display:this.state.isPhotoTaken?"none":"inline-block"},videoConstraints:x,screenshotFormat:"image/jpeg",ref:this.webcamRef}))),o.a.createElement(U.a,null),o.a.createElement(E.a,{style:{marginTop:30}},o.a.createElement(v.a,null,o.a.createElement("p",null,o.a.createElement(b.a,{variant:"primary",onClick:this.photoTake},this.state.isPhotoTaken?"Retake Photo":"Take A Photo"),o.a.createElement(b.a,{style:{marginLeft:30,display:this.state.isPhotoTaken?"inline-block":"none"},variant:"primary",onClick:this.photoCapture},"Upload")))),this.state.uploadingProgress>0&&o.a.createElement("div",null,o.a.createElement(E.a,{style:{marginTop:30}},o.a.createElement(v.a,null),o.a.createElement(v.a,null,o.a.createElement(k.a,{now:this.state.uploadingProgress,label:this.state.uploadingProgress+"%",animated:!0})),o.a.createElement(v.a,null)))),2===e&&o.a.createElement("div",null,o.a.createElement(E.a,{style:{marginTop:50}},o.a.createElement(v.a,null,o.a.createElement("h1",null,"Step 2. Verify Your Identity"))),o.a.createElement(U.a,null),o.a.createElement(E.a,{style:{marginTop:30}},o.a.createElement(v.a,null,o.a.createElement(b.a,{variant:"primary",onClick:this.comparePhoto},this.state.resultBtnStatus?"Upload again":"Verify")))),o.a.createElement(E.a,{style:{marginTop:30,marginBottom:30,color:this.state.msgColor}},o.a.createElement(v.a,null,this.state.resultMsg)),""!==this.state.blob&&o.a.createElement("img",{src:this.state.blob,alt:"blob"}))}}]),a}(o.a.Component),N=Object(s.f)(B),L=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this)).state={},n}return Object(d.a)(a,[{key:"goBack",value:function(){window.location.href="/"}},{key:"render",value:function(){return o.a.createElement(i.a,null,o.a.createElement(y.a,{style:{textAlign:"center"}},o.a.createElement("div",null,o.a.createElement(E.a,{style:{marginTop:150}},o.a.createElement(v.a,null,o.a.createElement("h2",null,"That info has been received and email has been sent to candidate. You can invite another candidate."))),o.a.createElement(E.a,{style:{marginTop:15}},o.a.createElement(v.a,null,o.a.createElement(b.a,{variant:"primary",onClick:this.goBack},"Go Back"))))))}}]),a}(o.a.Component),D=Object(s.f)(L),A=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(e){var n;return Object(m.a)(this,a),(n=t.call(this)).state={},n}return Object(d.a)(a,[{key:"goBack",value:function(){window.location.href="/"}},{key:"render",value:function(){return o.a.createElement(i.a,null,o.a.createElement(y.a,{style:{textAlign:"center"}},o.a.createElement("div",null,o.a.createElement(E.a,{style:{marginTop:150}},o.a.createElement(v.a,null,o.a.createElement("h2",null,"You uploaded your ID photo successfully!"))))))}}]),a}(o.a.Component),R=Object(s.f)(A),Y=(a(583),a(584),a(592)),F=function(e){Object(f.a)(a,e);var t=Object(g.a)(a);function a(){var e;return Object(m.a)(this,a),(e=t.call(this)).state={userInfo:{candidate_name_first:"",candidate_name_last:"",candidate_email:"",date_of_interview:"",social_link:"",interviewer_name_first:"",interviewer_name_last:"",interviewer_email:""},isUploading:!1},e.registerUserData=e.registerUserData.bind(Object(p.a)(e)),e.handleChange=e.handleChange.bind(Object(p.a)(e)),e}return Object(d.a)(a,[{key:"componentDidMount",value:function(){console.log(O.api.getUsers)}},{key:"registerUserData",value:function(e){var t=this;e.preventDefault();var a=this.state,n=a.userInfo,o=a.isUploading;console.log("------ userInfo: ",n),o||(this.setState({isUploading:!0}),fetch(O.api.registerUser,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(n)}).then((function(e){return e.json()})).then((function(e){e.status?fetch(O.api.sendMail,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({token:e.token})}).then((function(){t.setState({isUploading:!1}),window.location.href="/success"})):t.setState({isUploading:!1}),console.log("data",e.data)})))}},{key:"handleChange",value:function(e){var t=e.target.name,a=e.target.value,n=this.state.userInfo;n[t]=a,this.state.userInfo=n}},{key:"render",value:function(){return o.a.createElement(y.a,{style:{textAlign:"center"}},o.a.createElement("div",null,o.a.createElement(E.a,{style:{marginTop:50}},o.a.createElement(v.a,null,o.a.createElement("h1",null,"Step 1. Register New User"))),o.a.createElement(U.a,null),o.a.createElement(Y.a,{style:{textAlign:"left"}},o.a.createElement(E.a,{style:{marginTop:30}},o.a.createElement(Y.a.Group,{as:v.a,onChange:this.handleChange},o.a.createElement(Y.a.Label,null,"Candidate Name"),o.a.createElement(Y.a.Control,{type:"text",placeholder:"",name:"candidate_name_first"}),o.a.createElement(Y.a.Text,{className:"text-muted"},"First Name")),o.a.createElement(Y.a.Group,{as:v.a,onChange:this.handleChange},o.a.createElement(Y.a.Label,null,"\xa0"),o.a.createElement(Y.a.Control,{type:"text",placeholder:"",name:"candidate_name_last"}),o.a.createElement(Y.a.Text,{className:"text-muted"},"Last Name"))),o.a.createElement(E.a,null,o.a.createElement(Y.a.Group,{as:v.a,onChange:this.handleChange},o.a.createElement(Y.a.Label,null,"Candidate Email"),o.a.createElement(Y.a.Control,{type:"email",placeholder:"",name:"candidate_email"}),o.a.createElement(Y.a.Text,{className:"text-muted"},"example@example.com")),o.a.createElement(v.a,null)),o.a.createElement(E.a,null,o.a.createElement(Y.a.Group,{as:v.a,onChange:this.handleChange},o.a.createElement(Y.a.Label,null,"Date Of Interview"),o.a.createElement(Y.a.Control,{type:"date",placeholder:"",dateformat:"YYYY-MM-DD",name:"date_of_interview"}),o.a.createElement(Y.a.Text,{className:"text-muted"},"Date")),o.a.createElement(v.a,null)),o.a.createElement(E.a,null,o.a.createElement(Y.a.Group,{as:v.a,onChange:this.handleChange},o.a.createElement(Y.a.Label,null,"Zoom, Skype, Bluejeans, Hirevue link"),o.a.createElement(Y.a.Control,{type:"text",placeholder:"",name:"social_link"}),o.a.createElement(Y.a.Text,{className:"text-muted"},"http://www.zoom.us/1234567890")),o.a.createElement(v.a,null)),o.a.createElement(E.a,null,o.a.createElement(Y.a.Group,{as:v.a,onChange:this.handleChange},o.a.createElement(Y.a.Label,null,"Interviewer's Name"),o.a.createElement(Y.a.Control,{type:"text",placeholder:"",name:"interviewer_name_first"}),o.a.createElement(Y.a.Text,{className:"text-muted"},"First Name")),o.a.createElement(Y.a.Group,{as:v.a,onChange:this.handleChange},o.a.createElement(Y.a.Label,null,"\xa0"),o.a.createElement(Y.a.Control,{type:"text",placeholder:"",name:"interviewer_name_last"}),o.a.createElement(Y.a.Text,{className:"text-muted"},"Last Name"))),o.a.createElement(E.a,null,o.a.createElement(Y.a.Group,{as:v.a,onChange:this.handleChange},o.a.createElement(Y.a.Label,null,"Interviewer's Email"),o.a.createElement(Y.a.Control,{type:"email",placeholder:"",name:"interviewer_email"}),o.a.createElement(Y.a.Text,{className:"text-muted"},"example@example.com")),o.a.createElement(v.a,null)),o.a.createElement(U.a,null),o.a.createElement(E.a,{style:{marginTop:30,marginBottom:30,textAlign:"center"}},o.a.createElement(v.a,null,o.a.createElement(b.a,{variant:"primary",type:"submit",onClick:this.registerUserData},this.state.isUploading?"Uploading...":"Submit"))))))}}]),a}(o.a.Component);var J=function(){return o.a.createElement(i.a,null,o.a.createElement(c.a,{expand:"lg",variant:"light",bg:"light"},o.a.createElement(c.a.Brand,{href:"#"},"ID Authenticate"),o.a.createElement(u.a,{className:"mr-auto"})),o.a.createElement(s.c,null,o.a.createElement(s.a,{path:"/success",children:o.a.createElement(D,null)}),o.a.createElement(s.a,{path:"/idsuccess",children:o.a.createElement(R,null)}),o.a.createElement(s.a,{path:O.api.verifyID,children:o.a.createElement(N,null)}),o.a.createElement(s.a,{path:"/",children:o.a.createElement(F,null)})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(J,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[126,1,2]]]);
//# sourceMappingURL=main.915c7ae8.chunk.js.map